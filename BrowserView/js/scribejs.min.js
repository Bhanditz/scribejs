(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";const nicknames=require("./nicknames");const convert=require("../../lib/convert");async function bridge(form){const config={date:form.elements["date"].value,final:form.elements["final"].value==="true"?true:false,torepo:false,jekyll:form.elements["jekyll"].value,pandoc:true,nick_mappings:[],nicknames:form.elements["nicknames"].value,irc_format:undefined,ghname:"",ghemail:"",ghtoken:""};config.nicks=await nicknames.get_nick_mapping(config);const irc_log=form.elements["text"].value;const minutes=convert.to_markdown(irc_log,config);const target=document.getElementById("minutes");target.value=minutes}window.addEventListener("load",e=>{const submit_button=document.getElementById("submit_button");submit_button.addEventListener("click",e=>{const the_form=document.getElementById("main_form");bridge(the_form)})})},{"../../lib/convert":4,"./nicknames":2}],2:[function(require,module,exports){"use strict";const url=require("url");const validUrl=require("valid-url");const _=require("underscore");function check_url(address){const parsed=url.parse(address);if(parsed.protocol===null){return null}if(_.contains(["http:","https:"],parsed.protocol)===false){throw new Error(`Only http(s) url-s are accepted (${address})`)}const retval=validUrl.isWebUri(address);if(retval===undefined){throw new Error(`The url ${address} isn't valid`)}if(parsed.port!==null&&parsed.port<=1024){throw new Error(`Unsafe port number used in ${address} (${parsed.port})`)}return retval}exports.get_nick_mapping=(conf=>{function lower_nicks(nicks){return _.map(nicks,nick_structure=>{const lowered=_.map(nick_structure.nick,nick=>nick.toLowerCase());nick_structure.nick=lowered;return nick_structure})}return new Promise((resolve,reject)=>{if(conf.nicknames){const address=check_url(conf.nicknames);if(address!==null){fetch(address).then(response=>{if(response.ok){return response.text()}reject(new Error(`HTTP response ${response.status}: ${response.statusText}`))}).then(body=>{let json_content={};try{json_content=JSON.parse(body)}catch(err){throw new Error(`JSON parsing error in ${conf.nicknames}: ${err}`)}resolve(lower_nicks(json_content))}).catch(err=>{reject(new Error(`problem accessing remote file ${conf.nicknames}: ${err.message}`))})}}else{resolve([])}})})},{underscore:11,url:17,"valid-url":12}],3:[function(require,module,exports){"use strict";const _=require("underscore");const storage_key="scribejs_webstorage_presets";const retrieve_presets=()=>JSON.parse(localStorage.getItem(storage_key));const store_presets=all_presets=>{localStorage.setItem(storage_key,JSON.stringify(all_presets));generate_preset_menu(all_presets)};const JEKYLL_NONE="none";const JEKYLL_MARKDOWN="md";const JEKYLL_KRAMDOWN="kd";const boolean_keys=["torepo","final"];function set_presets(val){reset_preset_menu();if(val!=="None"){const all_presets=retrieve_presets();if(!_.isEmpty(all_presets)){if(all_presets[val]!==undefined){const preset=all_presets[val];Object.keys(preset).forEach(key=>{const value=preset[key];const element=document.getElementById(key);if(element){if(boolean_keys.indexOf(key)!==-1){element.selectedIndex=value?1:0}else if(key==="jekyll"){element.selectedIndex=value===JEKYLL_MARKDOWN?1:value===JEKYLL_KRAMDOWN?2:0}else{element.value=value}}})}}}}function reset_preset_menu(){const presets=document.getElementById("presets");presets.selectedIndex=0}function generate_preset_menu(all_presets){const select_element=document.getElementById("presets");select_element.innerHTML="";const none_element=document.createElement("option");none_element.textContent="None";none_element.setAttribute("value","None");none_element.setAttribute("selected","True");select_element.appendChild(none_element);if(_.isEmpty(all_presets)){console.log("No Presets")}else{_.forEach(all_presets,(value,key)=>{const descr=value.fullname;const option_element=document.createElement("option");option_element.textContent=descr;option_element.setAttribute("value",key);select_element.appendChild(option_element)})}}function list_presets(){console.log("--- Presets");let all_presets=retrieve_presets();_.forEach(get_presets(),(value,key)=>{console.log(value)});console.log("---")}function remove_preset(){const all_presets=retrieve_presets();const group=document.getElementById("group").value;store_presets(_.omit(all_presets,group))}function clear_presets(){store_presets({})}function store_preset(){const to_be_stored={};const group=document.getElementById("group").value;if(group!==""){const targets=["group","nicknames","ghrepo","ghpath","ghbranch","ghname","ghemail","ghtoken","fullname"];_.forEach(targets,key=>{const el=document.getElementById(key);if(el){const val=el.value;if(val!==""){to_be_stored[key]=val}}});if(to_be_stored.fullname===undefined||to_be_stored.fullname===""){to_be_stored.fullname=group}_.forEach(boolean_keys,key=>{const element=document.getElementById(key);if(element){to_be_stored[key]=element.selectedIndex===1}});const element=document.getElementById("jekyll");to_be_stored.jekyll=element.selectedIndex===1?JEKYLL_MARKDOWN:element.selectedIndex===2?JEKYLL_KRAMDOWN:JEKYLL_NONE;const all_presets=retrieve_presets();all_presets[group]=to_be_stored;store_presets(all_presets)}else{console.error("no group name (IRC channel) has been provided")}}function fetch_log(){const set_input_url=(date,group)=>{const[year,month,day]=date.split("-");return`https://cors-anywhere.herokuapp.com/https://www.w3.org/${year}/${month}/${day}-${group}-irc.txt`};const date=document.getElementById("date").value;const group=document.getElementById("group").value;if(group!==""&&date!==undefined&&date!==""){const target=document.getElementById("text");const url=set_input_url(date,group);fetch(url).then(response=>{if(response.ok){return response.text()}else{throw new Error(`HTTP response ${response.status}: ${response.statusText}`)}}).then(body=>{target.value=body}).catch(err=>{const message=`Problem accessing remote file ${url}: ${err.message}`;alert(message)})}else{alert("No irc name or no valid date...")}}function load_log(file){const reader=new FileReader;reader.addEventListener("loadend",e=>{const target=document.getElementById("text");target.value=reader.result});reader.readAsText(file)}function save_minutes(){const minutes=document.getElementById("minutes").value;if(minutes&&minutes!==""){const mBlob=new Blob([minutes],{type:"text/markdown"});const mURI=URL.createObjectURL(mBlob);const[year,month,day]=document.getElementById("date").value.split("-");const group=document.getElementById("group").value;const file_name=group&&group!==""?`${year}-${month}-${day}-${group}.md`:`${year}-${month}-${day}.md`;const download=document.getElementById("download");download.href=mURI;download.download=file_name;download.click()}}window.addEventListener("load",e=>{const all_presets=localStorage.getItem(storage_key);if(all_presets){generate_preset_menu(JSON.parse(all_presets))}else{store_presets({})}const zeropadding=n=>n<10?`0${n}`:`${n}`;const date=new Date;const month=zeropadding(date.getMonth()+1);const day=zeropadding(date.getDate());const year=date.getFullYear();const date_input=document.getElementById("date");date_input.value=`${year}-${month}-${day}`;const presets_button=document.getElementById("presets");presets_button.addEventListener("change",e=>{set_presets(presets_button.value)});const reset_button=document.getElementById("reset");reset_button.addEventListener("click",reset_preset_menu);const upload_log_button=document.getElementById("upload_log");upload_log_button.addEventListener("change",e=>{load_log(upload_log_button.files[0])});const fetch_log_button=document.getElementById("fetch_log");fetch_log_button.addEventListener("click",fetch_log);const store_preset_button=document.getElementById("store_preset");store_preset_button.addEventListener("click",store_preset);const remove_preset_button=document.getElementById("remove_preset");remove_preset_button.addEventListener("click",remove_preset);const clear_presets_button=document.getElementById("clear_presets");clear_presets_button.addEventListener("click",clear_presets);const save_button=document.getElementById("save");save_button.addEventListener("click",save_minutes)})},{underscore:11}],4:[function(require,module,exports){"use strict";const _=require("underscore");const url=require("url");const safe=require("safe-regex");const JEKYLL_NONE="none";const JEKYLL_KRAMDOWN="kd";exports.to_markdown=((body,config)=>{const kramdown=config.jekyll===JEKYLL_KRAMDOWN;function get_label(line){const reg=line.trim().match(/^(\w+):(.*)$/);if(reg===null){return{label:null,content:line}}const possible_label=reg[1].trim();const possible_content=reg[2].trim();if(["http","https","email","ftp"].includes(possible_label)){return{label:null,content:line}}if(possible_label==="..."){return{label:null,content:`... ${possible_content}`}}return{label:possible_label,content:possible_content}}function get_nick_mapping(nick){const clean_nick=nick.replace(/^_+/,"").replace(/_+$/,"").replace(/^@/,"");try{for(let i=0;i<config.nicks.length;i++){const struct=config.nicks[i];if(_.indexOf(struct.nick,clean_nick.toLowerCase())!==-1){return struct}}}catch(e){return null}return null}function get_name(nick){const clean_nick=nick.replace(/^_+/,"").replace(/_+$/,"").replace(/^@/,"");if(config.nick_mappings[clean_nick]){return config.nick_mappings[clean_nick]}const struct=get_nick_mapping(clean_nick);if(struct){config.nick_mappings[clean_nick]={name:struct.name};if(struct.url)config.nick_mappings[clean_nick].url=struct.url;return config.nick_mappings[clean_nick]}return{name:clean_nick.replace(/_/g," ")}}function cleanup_name(nick){return get_name(nick).name}function cleanup_names(nicks){return _.chain(nicks).map(get_name).map(obj=>obj.url?`[${obj.name}](${obj.url})`:obj.name).uniq().value()}function get_labelled_item(label,line){const lower=line.content.toLowerCase();const label_length=label.length+1;return lower.startsWith(`${label}:`)===true?line.content.slice(label_length).trim():null}const get_scribe=line=>get_labelled_item("scribenick",line)||get_labelled_item("scribe",line);function handle_scribejs(line_object){if(line_object.content_lower.startsWith("scribejs,")){try{const words=line_object.content.split(" ");switch(words[1]){case"set":{const nickname=words[2].toLowerCase();const name_comps=words.slice(3);if(name_comps.length!==0){config.nicks.push({nick:[nickname],name:name_comps.join(" ").replace(/_/g," ")})}break}default:{}}}catch(err){}return false}return true}function cleanup(body_to_clean){const split_body=_.isArray(body_to_clean)?body_to_clean:body_to_clean.split(/\n/);return _.chain(split_body).filter(line=>_.size(line)!==0).map(line=>line.slice(line.indexOf(" ")+1)).filter(line=>{if(config.irc_format===undefined){return true}switch(config.irc_format){case"textual":{const stripped_line=line.trim();return!(stripped_line.length===0||stripped_line[0]==="•"||stripped_line.startsWith("Disconnected for Sleep Mode")||stripped_line.includes("rrsagent")||stripped_line.includes("zakim")||stripped_line.includes("github-bot")||stripped_line.includes("joined the channel")||stripped_line.includes("------------- Begin Session -------------")||stripped_line.includes("------------- End Session -------------")||stripped_line.includes("changed the topic to"))}default:{return true}}}).map(line=>{const sp=line.indexOf(" ");return{nick:line.slice(1,sp-1),content:line.slice(sp+1).trim()}}).map(line_object=>{line_object.content=line_object.content.replace(/<(\w*\/?)>/g,"`<$1>`");return line_object}).map(line_object=>{line_object.content_lower=line_object.content.toLowerCase();return line_object}).filter(line_object=>line_object.nick!=="RRSAgent"&&line_object.nick!=="Zakim"&&line_object.nick!=="github-bot").filter(line_object=>!(line_object.content_lower.startsWith("q+")||line_object.content_lower.startsWith("+q")||line_object.content_lower.startsWith("q-")||line_object.content_lower.startsWith("q?")||line_object.content_lower.startsWith("ack")||line_object.content_lower.startsWith("agenda+")||line_object.content_lower.startsWith("agenda?")||line_object.content_lower.startsWith("trackbot,")||line_object.content_lower.startsWith("zakim,")||line_object.content_lower.startsWith("rrsagent,")||line_object.content_lower.startsWith("github topic")||line_object.content_lower.startsWith("github-bot,"))).filter(line_object=>{if(line_object.content.match(/^\w+ has joined #\w+/)){return false}return true}).filter(line_object=>!(line_object.content.match(/^\w+ has left #\w+/)||line_object.content.match(/^\w+ has changed the topic to:/))).filter(handle_scribejs).value()}function set_header(lines){const headers={present:[],regrets:[],guests:[],chair:[],agenda:"",date:config.date?config.date:"",scribe:[],meeting:""};function people(category,line){let real_category=category;if(category==="guest")real_category="guests";else if(category==="regret")real_category="regrets";const get_names=index=>{const retval=line.content.slice(index+1).trim().split(",");if(retval.length===0||retval.length===1&&retval[0].length===0){return[line.nick]}return retval};const lower=line.content_lower.trim();const cutIndex=category.length;if(lower.startsWith(category)===true){let action=_.union;let names=[];if(lower.startsWith(`${category}+`)===true){names=get_names(cutIndex)}else if(lower.startsWith(`${category} +`)===true){names=get_names(cutIndex+1)}else if(lower.startsWith(`${category}-`)===true){names=get_names(cutIndex);action=_.difference}else if(lower.startsWith(`${category} -`)===true){names=get_names(cutIndex+1);action=_.difference}else if(lower.startsWith(`${category}:`)===true){names=line.content.slice(cutIndex+1).trim().split(",")}else{return false}headers[real_category]=action(headers[real_category],_.map(names,name=>name.trim()));return true}return false}function single_item(category,line){const item=get_labelled_item(category,line);if(item!==null){headers[category]=item;return true}return false}function handle_scribes(line){const scribenick=get_scribe(line);if(scribenick!==null){headers.scribe.push(scribenick)}return true}const processed_lines=_.chain(lines).filter(line=>!people("present",line)).filter(line=>!people("regrets",line)).filter(line=>!people("regret",line)).filter(line=>!people("guests",line)).filter(line=>!people("guest",line)).filter(line=>!people("chair",line)).filter(line=>!single_item("agenda",line)).filter(line=>!single_item("meeting",line)).filter(line=>!single_item("date",line)).filter(line=>handle_scribes(line)).filter(line=>line.nick!=="trackbot").value();return{headers:_.mapObject(headers,val=>{if(_.isArray(val)){return cleanup_names(val).join(", ")}return val}),lines:processed_lines}}function perform_insert(lines){const insert_requests=[];const get_insert_request=str=>str.match(/^i\/([^/]+)\/([^/]+)\/{0,1}/)||str.match(/^i\|([^|]+)\|([^|]+)\|{0,1}/);const marker="----INSERTREQUESTXYZ----";const retval=_.chain(lines).reverse().map((line,index)=>{const r=get_insert_request(line.content);if(r!==null){insert_requests.push({lineno:index,at:r[1],add:r[2],valid:true});line.content=marker}return line}).map((line,index)=>{if(line.content!==marker){let map_retval=line;for(let i=0;i<insert_requests.length;i++){const insert=insert_requests[i];if(insert.valid&&index>insert.lineno&&line.content.indexOf(insert.at)!==-1){insert.valid=false;const new_line={nick:line.nick,content:insert.add,content_lower:insert.add.toLowerCase()};map_retval=[line,new_line];break}}return map_retval}return line}).flatten(true).filter(line=>line.content!==marker).reverse().value();return retval}function perform_changes(lines){const change_requests=[];const get_change_request=str=>str.match(/^s\/([^/]+)\/([^/]*)\/{0,1}(g|G){0,1}/)||str.match(/^s\|([^|]+)\|([^/|]*)\|{0,1}(g|G){0,1}/);const marker="----CHANGEREQUESTXYZ----";const retval=_.chain(lines).reverse().map((line,index)=>{const r=get_change_request(line.content);if(r!==null){if(safe(r[1])){change_requests.push({lineno:index,from:r[1],to:r[2],g:r[3]==="g",G:r[3]==="G",valid:true});line.content=marker}}return line}).map((line,index)=>{if(line.content!==marker){_.forEach(change_requests,change=>{if(change.valid&&(change.G||index>=change.lineno)){if(line.content.indexOf(change.from)!==-1){line.content=line.content.replace(RegExp(change.from,"g"),change.to);if(!(change.G||change.g)){change.valid=false}}}})}return line}).filter(line=>line.content!==marker).reverse().value();return retval}function generate_header_md(headers){let header_start="";if(config.jekyll!==JEKYLL_NONE){header_start=`---\nlayout: minutes\ndate: ${headers.date}\ntitle: ${headers.meeting} — ${headers.date}\n---\n`}else if(config.pandoc){header_start=`% ${headers.meeting} — ${headers.date}\n\n![W3C Logo](https://www.w3.org/Icons/w3c_home)\n\n`}else{header_start="![W3C Logo](https://www.w3.org/Icons/w3c_home)\n"}const draft_class=kramdown&&!config.final?"{: .draft_notice}":"";const no_toc=kramdown?"{: .no_toc}":"";const core_header=`\n# ${headers.meeting} — Minutes\n${no_toc}\n${config.final?"":"***– DRAFT Minutes –***"}\n${draft_class}\n\n**Date:** ${headers.date}\n\nSee also the [Agenda](${headers.agenda}) and the [IRC Log](${config.orig_irc_log})\n\n## Attendees\n${no_toc}\n**Present:** ${headers.present}\n\n**Regrets:** ${headers.regrets}\n\n**Guests:** ${headers.guests}\n\n**Chair:** ${headers.chair}\n\n**Scribe(s):** ${headers.scribe}\n`;return header_start+core_header}function generate_content_md(lines){let content_md="\n---\n";let TOC="\n## Content:\n";const jekyll_toc="\n## Content:\n{: .no_toc}\n\n* TOC\n{:toc}";let resolutions="";let actions="";let sec_number_level_1=0;let sec_number_level_2=0;let numbering="";let header_level="";let toc_spaces="";function add_toc(content,level){let id="";if(level===1){sec_number_level_1+=1;numbering=sec_number_level_1;sec_number_level_2=0;header_level="### ";toc_spaces="";id=`section${sec_number_level_1}`}else{sec_number_level_2+=1;numbering=`${sec_number_level_1}.${sec_number_level_2}`;header_level="#### ";toc_spaces="    ";id=`section${sec_number_level_1}-${sec_number_level_2}`}if(kramdown){content_md=content_md.concat("\n\n",`${header_level}${numbering}. ${content}\n{: #${id}}`)}else{content_md=content_md.concat("\n\n",`${header_level}[${numbering}. ${content}](id:${id})`)}TOC=TOC.concat(`${toc_spaces}* [${numbering}. ${content}](#${id})\n`)}let rcounter=1;function add_resolution(content){const id=`resolution${rcounter}`;if(kramdown){content_md=content_md.concat(`\n\n> ***Resolution #${rcounter}: ${content}***\n{: #${id} .resolution}`)}else{content_md=content_md.concat(`\n\n> [***Resolution #${rcounter}: ${content}***](id:${id})`)}resolutions=resolutions.concat(`\n* [Resolution #${rcounter}](#${id}): ${content}`);rcounter+=1}let acounter=1;function add_action(content){const words=content.trim().split(" ");if(words[1]==="to"){words[0]=cleanup_name(words[0])}const final_content=words.join(" ");const id=`action${acounter}`;if(kramdown){content_md=content_md.concat(`\n\n> ***Action #${acounter}: ${final_content}***\n{: #${id} .action}`)}else{content_md=content_md.concat(`\n\n> [***Action #${acounter}: ${final_content}***](id:${id})`)}actions=actions.concat(`\n* [Action #${acounter}](#${id}): ${final_content}`);acounter+=1}function add_links(line){const check=str=>{const a=url.parse(str);return a.protocol!==null&&_.indexOf(["http:","https:","ftp:","mailto:","doi:"],a.protocol)!==-1};return _.map(line.split(" "),word=>check(word)?`[${word}](${word})`:word).join(" ")}let current_scribe="";let within_scribed_content=false;let current_person="";_.forEach(lines,line_object=>{const scribe=get_scribe(line_object);if(scribe!==null){current_scribe=scribe.toLowerCase();return}const{label:label,content:content}=get_label(line_object.content);if(label!==null&&label.toLowerCase()==="topic"){within_scribed_content=false;add_toc(content,1)}else if(label!==null&&label.toLowerCase()==="subtopic"){within_scribed_content=false;add_toc(content,2)}else if(label!==null&&["proposed","proposal","propose"].includes(label.toLowerCase())){within_scribed_content=false;content_md=content_md.concat(`\n\n> **Proposed resolution: ${content}** *(${cleanup_name(line_object.nick)})*`);if(kramdown){content_md=content_md.concat("\n{: .proposed_resolution}")}}else if(label!==null&&label.toLowerCase()==="summary"){within_scribed_content=false;content_md=content_md.concat(`\n\n> **Summary: ${content}** *(${cleanup_name(line_object.nick)})*`);if(kramdown){content_md=content_md.concat("\n{: .summary}")}}else if(label!==null&&["resolved","resolution"].includes(label.toLowerCase())){within_scribed_content=false;add_resolution(content)}else if(label!==null&&label.toLowerCase()==="action"){within_scribed_content=false;add_action(content)}else if(line_object.nick.toLowerCase()===current_scribe){if(label!==null){content_md=content_md.concat(`\n\n**${cleanup_name(label)}:** ${content}  `);within_scribed_content=true;current_person=label}else{let dots=0;if(content.startsWith("..."))dots=3;else if(content.startsWith("…"))dots=1;if(dots>0){let new_content=content.slice(dots).trim();if(new_content&&new_content[0]===":"){new_content=new_content.slice(1)}if(within_scribed_content){content_md=content_md.concat("\n… ",new_content,"  ")}else{content_md=content_md.concat(`\n\n**${cleanup_name(current_person)}:** ${new_content}  `);within_scribed_content=true}}else{within_scribed_content=false;content_md=content_md.concat("\n\n> *",cleanup_name(line_object.nick),":* ",add_links(line_object.content))}}}else{within_scribed_content=false;content_md=content_md.concat("\n\n> *",cleanup_name(line_object.nick),":* ",add_links(line_object.content))}});content_md=content_md.concat("\n\n---\n");if(rcounter>1){sec_number_level_1+=1;TOC=TOC.concat(`* [${sec_number_level_1}. Resolutions](#res)\n`);if(kramdown){content_md=content_md.concat(`\n\n### ${sec_number_level_1}. Resolutions\n{: #res}\n${resolutions}`)}else{content_md=content_md.concat(`\n\n### [${sec_number_level_1}. Resolutions](id:res)\n${resolutions}`)}}if(acounter>1){sec_number_level_1+=1;TOC=TOC.concat(`* [${sec_number_level_1}. Action Items](#act)\n`);if(kramdown){content_md=content_md.concat(`\n\n### ${sec_number_level_1}. Action Items\n{: #act}\n${actions}`)}else{content_md=content_md.concat(`\n\n### [${sec_number_level_1}. Action Items](id:act)\n${actions}`)}}return(kramdown?jekyll_toc:TOC)+content_md}let{headers:headers,lines:lines}=set_header(cleanup(body));lines=perform_insert(lines);lines=perform_changes(lines);return generate_header_md(headers)+generate_content_md(lines)})},{"safe-regex":10,underscore:11,url:17}],5:[function(require,module,exports){var util=require("./util");var types=require("./types");var sets=require("./sets");var positions=require("./positions");module.exports=function(regexpStr){var i=0,l,c,start={type:types.ROOT,stack:[]},lastGroup=start,last=start.stack,groupStack=[];var repeatErr=function(i){util.error(regexpStr,"Nothing to repeat at column "+(i-1))};var str=util.strToChars(regexpStr);l=str.length;while(i<l){c=str[i++];switch(c){case"\\":c=str[i++];switch(c){case"b":last.push(positions.wordBoundary());break;case"B":last.push(positions.nonWordBoundary());break;case"w":last.push(sets.words());break;case"W":last.push(sets.notWords());break;case"d":last.push(sets.ints());break;case"D":last.push(sets.notInts());break;case"s":last.push(sets.whitespace());break;case"S":last.push(sets.notWhitespace());break;default:if(/\d/.test(c)){last.push({type:types.REFERENCE,value:parseInt(c,10)})}else{last.push({type:types.CHAR,value:c.charCodeAt(0)})}}break;case"^":last.push(positions.begin());break;case"$":last.push(positions.end());break;case"[":var not;if(str[i]==="^"){not=true;i++}else{not=false}var classTokens=util.tokenizeClass(str.slice(i),regexpStr);i+=classTokens[1];last.push({type:types.SET,set:classTokens[0],not:not});break;case".":last.push(sets.anyChar());break;case"(":var group={type:types.GROUP,stack:[],remember:true};c=str[i];if(c==="?"){c=str[i+1];i+=2;if(c==="="){group.followedBy=true}else if(c==="!"){group.notFollowedBy=true}else if(c!==":"){util.error(regexpStr,"Invalid group, character '"+c+"' after '?' at column "+(i-1))}group.remember=false}last.push(group);groupStack.push(lastGroup);lastGroup=group;last=group.stack;break;case")":if(groupStack.length===0){util.error(regexpStr,"Unmatched ) at column "+(i-1))}lastGroup=groupStack.pop();last=lastGroup.options?lastGroup.options[lastGroup.options.length-1]:lastGroup.stack;break;case"|":if(!lastGroup.options){lastGroup.options=[lastGroup.stack];delete lastGroup.stack}var stack=[];lastGroup.options.push(stack);last=stack;break;case"{":var rs=/^(\d+)(,(\d+)?)?\}/.exec(str.slice(i)),min,max;if(rs!==null){if(last.length===0){repeatErr(i)}min=parseInt(rs[1],10);max=rs[2]?rs[3]?parseInt(rs[3],10):Infinity:min;i+=rs[0].length;last.push({type:types.REPETITION,min:min,max:max,value:last.pop()})}else{last.push({type:types.CHAR,value:123})}break;case"?":if(last.length===0){repeatErr(i)}last.push({type:types.REPETITION,min:0,max:1,value:last.pop()});break;case"+":if(last.length===0){repeatErr(i)}last.push({type:types.REPETITION,min:1,max:Infinity,value:last.pop()});break;case"*":if(last.length===0){repeatErr(i)}last.push({type:types.REPETITION,min:0,max:Infinity,value:last.pop()});break;default:last.push({type:types.CHAR,value:c.charCodeAt(0)})}}if(groupStack.length!==0){util.error(regexpStr,"Unterminated group")}return start};module.exports.types=types},{"./positions":6,"./sets":7,"./types":8,"./util":9}],6:[function(require,module,exports){var types=require("./types");exports.wordBoundary=function(){return{type:types.POSITION,value:"b"}};exports.nonWordBoundary=function(){return{type:types.POSITION,value:"B"}};exports.begin=function(){return{type:types.POSITION,value:"^"}};exports.end=function(){return{type:types.POSITION,value:"$"}}},{"./types":8}],7:[function(require,module,exports){var types=require("./types");var INTS=function(){return[{type:types.RANGE,from:48,to:57}]};var WORDS=function(){return[{type:types.CHAR,value:95},{type:types.RANGE,from:97,to:122},{type:types.RANGE,from:65,to:90}].concat(INTS())};var WHITESPACE=function(){return[{type:types.CHAR,value:9},{type:types.CHAR,value:10},{type:types.CHAR,value:11},{type:types.CHAR,value:12},{type:types.CHAR,value:13},{type:types.CHAR,value:32},{type:types.CHAR,value:160},{type:types.CHAR,value:5760},{type:types.CHAR,value:6158},{type:types.CHAR,value:8192},{type:types.CHAR,value:8193},{type:types.CHAR,value:8194},{type:types.CHAR,value:8195},{type:types.CHAR,value:8196},{type:types.CHAR,value:8197},{type:types.CHAR,value:8198},{type:types.CHAR,value:8199},{type:types.CHAR,value:8200},{type:types.CHAR,value:8201},{type:types.CHAR,value:8202},{type:types.CHAR,value:8232},{type:types.CHAR,value:8233},{type:types.CHAR,value:8239},{type:types.CHAR,value:8287},{type:types.CHAR,value:12288},{type:types.CHAR,value:65279}]};var NOTANYCHAR=function(){return[{type:types.CHAR,value:10},{type:types.CHAR,value:13},{type:types.CHAR,value:8232},{type:types.CHAR,value:8233}]};exports.words=function(){return{type:types.SET,set:WORDS(),not:false}};exports.notWords=function(){return{type:types.SET,set:WORDS(),not:true}};exports.ints=function(){return{type:types.SET,set:INTS(),not:false}};exports.notInts=function(){return{type:types.SET,set:INTS(),not:true}};exports.whitespace=function(){return{type:types.SET,set:WHITESPACE(),not:false}};exports.notWhitespace=function(){return{type:types.SET,set:WHITESPACE(),not:true}};exports.anyChar=function(){return{type:types.SET,set:NOTANYCHAR(),not:true}}},{"./types":8}],8:[function(require,module,exports){module.exports={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7}},{}],9:[function(require,module,exports){var types=require("./types");var sets=require("./sets");var CTRL="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?";var SLSH={0:0,t:9,n:10,v:11,f:12,r:13};exports.strToChars=function(str){var chars_regex=/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z\[\\\]\^?])|([0tnvfr]))/g;str=str.replace(chars_regex,function(s,b,lbs,a16,b16,c8,dctrl,eslsh){if(lbs){return s}var code=b?8:a16?parseInt(a16,16):b16?parseInt(b16,16):c8?parseInt(c8,8):dctrl?CTRL.indexOf(dctrl):SLSH[eslsh];var c=String.fromCharCode(code);if(/[\[\]{}\^$.|?*+()]/.test(c)){c="\\"+c}return c});return str};exports.tokenizeClass=function(str,regexpStr){var tokens=[];var regexp=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?(.)/g;var rs,c;while((rs=regexp.exec(str))!=null){if(rs[1]){tokens.push(sets.words())}else if(rs[2]){tokens.push(sets.ints())}else if(rs[3]){tokens.push(sets.whitespace())}else if(rs[4]){tokens.push(sets.notWords())}else if(rs[5]){tokens.push(sets.notInts())}else if(rs[6]){tokens.push(sets.notWhitespace())}else if(rs[7]){tokens.push({type:types.RANGE,from:(rs[8]||rs[9]).charCodeAt(0),to:rs[10].charCodeAt(0)})}else if(c=rs[12]){tokens.push({type:types.CHAR,value:c.charCodeAt(0)})}else{return[tokens,regexp.lastIndex]}}exports.error(regexpStr,"Unterminated character class")};exports.error=function(regexp,msg){throw new SyntaxError("Invalid regular expression: /"+regexp+"/: "+msg)}},{"./sets":7,"./types":8}],10:[function(require,module,exports){var parse=require("ret");var types=parse.types;module.exports=function(re,opts){if(!opts)opts={};var replimit=opts.limit===undefined?25:opts.limit;if(isRegExp(re))re=re.source;else if(typeof re!=="string")re=String(re);try{re=parse(re)}catch(err){return false}var reps=0;return function walk(node,starHeight){if(node.type===types.REPETITION){starHeight++;reps++;if(starHeight>1)return false;if(reps>replimit)return false}if(node.options){for(var i=0,len=node.options.length;i<len;i++){var ok=walk({stack:node.options[i]},starHeight);if(!ok)return false}}var stack=node.stack||node.value&&node.value.stack;if(!stack)return true;for(var i=0;i<stack.length;i++){var ok=walk(stack[i],starHeight);if(!ok)return false}return true}(re,0)};function isRegExp(x){return{}.toString.call(x)==="[object RegExp]"}},{ret:5}],11:[function(require,module,exports){(function(global){(function(){var root=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||this||{};var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype;var SymbolProto=typeof Symbol!=="undefined"?Symbol.prototype:null;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!="undefined"&&!exports.nodeType){if(typeof module!="undefined"&&!module.nodeType&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.9.1";var optimizeCb=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};var builtinIteratee;var cb=function(value,context,argCount){if(_.iteratee!==builtinIteratee)return _.iteratee(value,context);if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value)&&!_.isArray(value))return _.matcher(value);return _.property(value)};_.iteratee=builtinIteratee=function(value,context){return cb(value,context,Infinity)};var restArguments=function(func,startIndex){startIndex=startIndex==null?func.length-1:+startIndex;return function(){var length=Math.max(arguments.length-startIndex,0),rest=Array(length),index=0;for(;index<length;index++){rest[index]=arguments[index+startIndex]}switch(startIndex){case 0:return func.call(this,rest);case 1:return func.call(this,arguments[0],rest);case 2:return func.call(this,arguments[0],arguments[1],rest)}var args=Array(startIndex+1);for(index=0;index<startIndex;index++){args[index]=arguments[index]}args[startIndex]=rest;return func.apply(this,args)}};var baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result};var shallowProperty=function(key){return function(obj){return obj==null?void 0:obj[key]}};var has=function(obj,path){return obj!=null&&hasOwnProperty.call(obj,path)};var deepGet=function(obj,path){var length=path.length;for(var i=0;i<length;i++){if(obj==null)return void 0;obj=obj[path[i]]}return length?obj:void 0};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var getLength=shallowProperty("length");var isArrayLike=function(collection){var length=getLength(collection);return typeof length=="number"&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj)}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj)}}return obj};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};var createReduce=function(dir){var reducer=function(obj,iteratee,memo,initial){var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(!initial){memo=obj[keys?keys[index]:index];index+=dir}for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo};return function(obj,iteratee,memo,context){var initial=arguments.length>=3;return reducer(obj,optimizeCb(iteratee,context,4),memo,initial)}};_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var keyFinder=isArrayLike(obj)?_.findIndex:_.findKey;var key=keyFinder(obj,predicate,context);if(key!==void 0&&key!==-1)return obj[key]};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){if(!isArrayLike(obj))obj=_.values(obj);if(typeof fromIndex!="number"||guard)fromIndex=0;return _.indexOf(obj,item,fromIndex)>=0};_.invoke=restArguments(function(obj,path,args){var contextPath,func;if(_.isFunction(path)){func=path}else if(_.isArray(path)){contextPath=path.slice(0,-1);path=path[path.length-1]}return _.map(obj,function(context){var method=func;if(!method){if(contextPath&&contextPath.length){context=deepGet(context,contextPath)}if(context==null)return void 0;method=context[path]}return method==null?method:method.apply(context,args)})});_.pluck=function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null||typeof iteratee=="number"&&typeof obj[0]!="object"&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value!=null&&value>result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(v,index,list){computed=iteratee(v,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=v;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null||typeof iteratee=="number"&&typeof obj[0]!="object"&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value!=null&&value<result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(v,index,list){computed=iteratee(v,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=v;lastComputed=computed}})}return result};_.shuffle=function(obj){return _.sample(obj,Infinity)};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)]}var sample=isArrayLike(obj)?_.clone(obj):_.values(obj);var length=getLength(sample);n=Math.max(Math.min(n,length),0);var last=length-1;for(var index=0;index<n;index++){var rand=_.random(index,last);var temp=sample[index];sample[index]=sample[rand];sample[rand]=temp}return sample.slice(0,n)};_.sortBy=function(obj,iteratee,context){var index=0;iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,key,list){return{value:value,index:index++,criteria:iteratee(value,key,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior,partition){return function(obj,iteratee,context){var result=partition?[[],[]]:{};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};_.groupBy=group(function(result,value,key){if(has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(has(result,key))result[key]++;else result[key]=1});var reStrSymbol=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(_.isString(obj)){return obj.match(reStrSymbol)}if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?obj.length:_.keys(obj).length};_.partition=group(function(result,value,pass){result[pass?0:1].push(value)},true);_.first=_.head=_.take=function(array,n,guard){if(array==null||array.length<1)return n==null?void 0:[];if(n==null||guard)return array[0];return _.initial(array,array.length-n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,n,guard){if(array==null||array.length<1)return n==null?void 0:[];if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,Boolean)};var flatten=function(input,shallow,strict,output){output=output||[];var idx=output.length;for(var i=0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(shallow){var j=0,len=value.length;while(j<len)output[idx++]=value[j++]}else{flatten(value,shallow,strict,output);idx=output.length}}else if(!strict){output[idx++]=value}}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false)};_.without=restArguments(function(array,otherArrays){return _.difference(array,otherArrays)});_.uniq=_.unique=function(array,isSorted,iteratee,context){if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=cb(iteratee,context);var result=[];var seen=[];for(var i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted&&!iteratee){if(!i||seen!==computed)result.push(value);seen=computed}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value)}}else if(!_.contains(result,value)){result.push(value)}}return result};_.union=restArguments(function(arrays){return _.uniq(flatten(arrays,true,true))});_.intersection=function(array){var result=[];var argsLength=arguments.length;for(var i=0,length=getLength(array);i<length;i++){var item=array[i];if(_.contains(result,item))continue;var j;for(j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break}if(j===argsLength)result.push(item)}return result};_.difference=restArguments(function(array,rest){rest=flatten(rest,true,true);return _.filter(array,function(value){return!_.contains(rest,value)})});_.unzip=function(array){var length=array&&_.max(array,getLength).length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index)}return result};_.zip=restArguments(_.unzip);_.object=function(list,values){var result={};for(var i=0,length=getLength(list);i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};var createPredicateIndexFinder=function(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=getLength(array);var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array))return index}return-1}};_.findIndex=createPredicateIndexFinder(1);_.findLastIndex=createPredicateIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=getLength(array);while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};var createIndexFinder=function(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if(typeof idx=="number"){if(dir>0){i=idx>=0?idx:Math.max(idx+length,i)}else{length=idx>=0?Math.min(idx+1,length):idx+length+1}}else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1}if(item!==item){idx=predicateFind(slice.call(array,i,length),_.isNaN);return idx>=0?idx+i:-1}for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir){if(array[idx]===item)return idx}return-1}};_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex);_.lastIndexOf=createIndexFinder(-1,_.findLastIndex);_.range=function(start,stop,step){if(stop==null){stop=start||0;start=0}if(!step){step=stop<start?-1:1}var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start}return range};_.chunk=function(array,count){if(count==null||count<1)return[];var result=[];var i=0,length=array.length;while(i<length){result.push(slice.call(array,i,i+=count))}return result};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self};_.bind=restArguments(function(func,context,args){if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var bound=restArguments(function(callArgs){return executeBound(func,bound,context,this,args.concat(callArgs))});return bound});_.partial=restArguments(function(func,boundArgs){var placeholder=_.partial.placeholder;var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===placeholder?arguments[position++]:boundArgs[i]}while(position<arguments.length)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound});_.partial.placeholder=_;_.bindAll=restArguments(function(obj,keys){keys=flatten(keys,false,false);var index=keys.length;if(index<1)throw new Error("bindAll must be passed function names");while(index--){var key=keys[index];obj[key]=_.bind(obj[key],obj)}});_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=""+(hasher?hasher.apply(this,arguments):key);if(!has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=restArguments(function(func,wait,args){return setTimeout(function(){return func.apply(null,args)},wait)});_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var timeout,context,args,result;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};var throttled=function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result};throttled.cancel=function(){clearTimeout(timeout);previous=0;timeout=context=args=null};return throttled};_.debounce=function(func,wait,immediate){var timeout,result;var later=function(context,args){timeout=null;if(args)result=func.apply(context,args)};var debounced=restArguments(function(args){if(timeout)clearTimeout(timeout);if(immediate){var callNow=!timeout;timeout=setTimeout(later,wait);if(callNow)result=func.apply(this,args)}else{timeout=_.delay(later,wait,this,args)}return result});debounced.cancel=function(){clearTimeout(timeout);timeout=null};return debounced};_.wrap=function(func,wrapper){return _.partial(wrapper,func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments)}if(times<=1)func=null;return memo}};_.once=_.partial(_.before,2);_.restArguments=restArguments;var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString");var nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];var collectNonEnumProps=function(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=_.isFunction(constructor)&&constructor.prototype||ObjProto;var prop="constructor";if(has(obj,prop)&&!_.contains(keys,prop))keys.push(prop);while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)){keys.push(prop)}}};_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(has(obj,key))keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={};for(var index=0;index<length;index++){var currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};var createAssigner=function(keysFunc,defaults){return function(obj){var length=arguments.length;if(defaults)obj=Object(obj);if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!defaults||obj[key]===void 0)obj[key]=source[key]}}return obj}};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};var keyInObj=function(value,key,obj){return key in obj};_.pick=restArguments(function(obj,keys){var result={},iteratee=keys[0];if(obj==null)return result;if(_.isFunction(iteratee)){if(keys.length>1)iteratee=optimizeCb(iteratee,keys[1]);keys=_.allKeys(obj)}else{iteratee=keyInObj;keys=flatten(keys,false,false);obj=Object(obj)}for(var i=0,length=keys.length;i<length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj))result[key]=value}return result});_.omit=restArguments(function(obj,keys){var iteratee=keys[0],context;if(_.isFunction(iteratee)){iteratee=_.negate(iteratee);if(keys.length>1)context=keys[1]}else{keys=_.map(flatten(keys,false,false),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)});_.defaults=createAssigner(_.allKeys,true);_.create=function(prototype,props){var result=baseCreate(prototype);if(props)_.extendOwn(result,props);return result};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false}return true};var eq,deepEq;eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return false;if(a!==a)return b!==b;var type=typeof a;if(type!=="function"&&type!=="object"&&typeof b!="object")return false;return deepEq(a,b,aStack,bStack)};deepEq=function(a,b,aStack,bStack){if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case"[object RegExp]":case"[object String]":return""+a===""+b;case"[object Number]":if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b;case"[object Symbol]":return SymbolProto.valueOf.call(a)===SymbolProto.valueOf.call(b)}var areArrays=className==="[object Array]";if(!areArrays){if(typeof a!="object"||typeof b!="object")return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&("constructor"in a&&"constructor"in b)){return false}}aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b}aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--){if(!eq(a[length],b[length],aStack,bStack))return false}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=keys[length];if(!(has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false}}aStack.pop();bStack.pop();return true};_.isEqual=function(a,b){return eq(a,b)};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj};_.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return has(obj,"callee")}}var nodelist=root.document&&root.document.childNodes;if(typeof/./!="function"&&typeof Int8Array!="object"&&typeof nodelist!="function"){_.isFunction=function(obj){return typeof obj=="function"||false}}_.isFinite=function(obj){return!_.isSymbol(obj)&&isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&isNaN(obj)};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,path){if(!_.isArray(path)){return has(obj,path)}var length=path.length;for(var i=0;i<length;i++){var key=path[i];if(obj==null||!hasOwnProperty.call(obj,key)){return false}obj=obj[key]}return!!length};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};_.property=function(path){if(!_.isArray(path)){return shallowProperty(path)}return function(obj){return deepGet(obj,path)}};_.propertyOf=function(obj){if(obj==null){return function(){}}return function(path){return!_.isArray(path)?obj[path]:deepGet(obj,path)}};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs)}};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match]};var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(obj,path,fallback){if(!_.isArray(path))path=[path];var length=path.length;if(!length){return _.isFunction(fallback)?fallback.call(obj):fallback}for(var i=0;i<length;i++){var prop=obj==null?void 0:obj[path[i]];if(prop===void 0){prop=fallback;i=length}obj=_.isFunction(prop)?prop.call(obj):prop}return obj};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var escapeRegExp=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escapeRegExp,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}else if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}else if(evaluate){source+="';\n"+evaluate+"\n__p+='"}return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";var render;try{render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}var template=function(data){return render.call(this,data,_)};var argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var chainResult=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return chainResult(this,func.apply(_,args))}});return _};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0)delete obj[0];return chainResult(this,obj)}});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return chainResult(this,method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return String(this._wrapped)};if(typeof define=="function"&&define.amd){define("underscore",[],function(){return _})}})()}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],12:[function(require,module,exports){(function(module){"use strict";module.exports.is_uri=is_iri;module.exports.is_http_uri=is_http_iri;module.exports.is_https_uri=is_https_iri;module.exports.is_web_uri=is_web_iri;module.exports.isUri=is_iri;module.exports.isHttpUri=is_http_iri;module.exports.isHttpsUri=is_https_iri;module.exports.isWebUri=is_web_iri;var splitUri=function(uri){var splitted=uri.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return splitted};function is_iri(value){if(!value){return}if(/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(value))return;if(/%[^0-9a-f]/i.test(value))return;if(/%[0-9a-f](:?[^0-9a-f]|$)/i.test(value))return;var splitted=[];var scheme="";var authority="";var path="";var query="";var fragment="";var out="";splitted=splitUri(value);scheme=splitted[1];authority=splitted[2];path=splitted[3];query=splitted[4];fragment=splitted[5];if(!(scheme&&scheme.length&&path.length>=0))return;if(authority&&authority.length){if(!(path.length===0||/^\//.test(path)))return}else{if(/^\/\//.test(path))return}if(!/^[a-z][a-z0-9\+\-\.]*$/.test(scheme.toLowerCase()))return;out+=scheme+":";if(authority&&authority.length){out+="//"+authority}out+=path;if(query&&query.length){out+="?"+query}if(fragment&&fragment.length){out+="#"+fragment}return out}function is_http_iri(value,allowHttps){if(!is_iri(value)){return}var splitted=[];var scheme="";var authority="";var path="";var port="";var query="";var fragment="";var out="";splitted=splitUri(value);scheme=splitted[1];authority=splitted[2];path=splitted[3];query=splitted[4];fragment=splitted[5];if(!scheme)return;if(allowHttps){if(scheme.toLowerCase()!="https")return}else{if(scheme.toLowerCase()!="http")return}if(!authority){return}if(/:(\d+)$/.test(authority)){port=authority.match(/:(\d+)$/)[0];authority=authority.replace(/:\d+$/,"")}out+=scheme+":";out+="//"+authority;if(port){out+=port}out+=path;if(query&&query.length){out+="?"+query}if(fragment&&fragment.length){out+="#"+fragment}return out}function is_https_iri(value){return is_http_iri(value,true)}function is_web_iri(value){return is_http_iri(value)||is_https_iri(value)}})(module)},{}],13:[function(require,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=typeof module=="object"&&module&&!module.nodeType&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw new RangeError(errors[type])}function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length])}return result}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1]}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){return map(array,function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);return output}).join("")}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic")}output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input")}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow")}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow")}w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow")}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",function(){return punycode})}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],14:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],15:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],16:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":14,"./encode":15}],17:[function(require,module,exports){"use strict";var punycode=require("punycode");var util=require("./util");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url;function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;u.parse(url,parseQueryString,slashesDenoteHost);return u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url)){throw new TypeError("Parameter 'url' must be a string, not "+typeof url)}var queryIndex=url.indexOf("?"),splitter=queryIndex!==-1&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/");url=uSplit.join(splitter);var rest=url;rest=rest.trim();if(!slashesDenoteHost&&url.split("#").length===1){var simplePath=simplePathPattern.exec(rest);if(simplePath){this.path=rest;this.href=rest;this.pathname=simplePath[1];if(simplePath[2]){this.search=simplePath[2];if(parseQueryString){this.query=querystring.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(parseQueryString){this.search="";this.query={}}return this}}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}var auth,atSign;if(hostEnd===-1){atSign=rest.lastIndexOf("@")}else{atSign=rest.lastIndexOf("@",hostEnd)}if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth)}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}if(hostEnd===-1)hostEnd=rest.length;this.host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x"}else{newpart+=part[j]}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length){rest="/"+notHost.join(".")+rest}this.hostname=validParts.join(".");break}}}}if(this.hostname.length>hostnameMaxLen){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!ipv6Hostname){this.hostname=punycode.toASCII(this.hostname)}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(rest.indexOf(ae)===-1)continue;var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae)}rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString){this.query=querystring.parse(this.query)}rest=rest.slice(0,qm)}else if(parseQueryString){this.search="";this.query={}}if(rest)this.pathname=rest;if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s}this.href=this.format();return this};function urlFormat(obj){if(util.isString(obj))obj=urlParse(obj);if(!(obj instanceof Url))return Url.prototype.format.call(obj);return obj.format()}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host){host=auth+this.host}else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){host+=":"+this.port}}if(this.query&&util.isObject(this.query)&&Object.keys(this.query).length){query=querystring.stringify(this.query)}var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname}else if(!host){host=""}if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)});search=search.replace("#","%23");return protocol+host+pathname+search+hash};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative)}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format()};function urlResolveObject(source,relative){if(!source)return relative;return urlParse(source,false,true).resolveObject(relative)}Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,false,true);relative=rel}var result=new Url;var tkeys=Object.keys(this);for(var tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result}if(relative.slashes&&!relative.protocol){var rkeys=Object.keys(relative);for(var rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];if(rkey!=="protocol")result[rkey]=relative[rkey]}if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname){result.path=result.pathname="/"}result.href=result.format();return result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){var keys=Object.keys(relative);for(var v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}result.href=result.format();return result}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift()));if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");result.pathname=relPath.join("/")}else{result.pathname=relative.pathname}result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result}var isSourceAbs=result.pathname&&result.pathname.charAt(0)==="/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host){if(srcPath[0]==="")srcPath[0]=result.host;else srcPath.unshift(result.host)}result.host="";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host){if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host)}relative.host=null}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath)srcPath=[];srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query}else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}result.search=relative.search;result.query=relative.query;if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.href=result.format();return result}if(!srcPath.length){result.pathname=null;if(result.search){result.path="/"+result.search}else{result.path=null}result.href=result.format();return result}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last==="."){srcPath.splice(i,1)}else if(last===".."){srcPath.splice(i,1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..")}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("")}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("")}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("")}if(!srcPath.length){result.pathname=null;result.path=null}else{result.pathname=srcPath.join("/")}if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;result.href=result.format();return result};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){this.port=port.substr(1)}host=host.substr(0,host.length-port.length)}if(host)this.hostname=host}},{"./util":18,punycode:13,querystring:16}],18:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return typeof arg==="string"},isObject:function(arg){return typeof arg==="object"&&arg!==null},isNull:function(arg){return arg===null},isNullOrUndefined:function(arg){return arg==null}}},{}]},{},[3,1]);
